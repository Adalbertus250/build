import {useState, ReactNode, useEffect} from "react";
import {motion, useAnimation} from "framer-motion";

export default function MWPreloader({children}: {children: ReactNode}){

    const [state, setState] = useState(true)

    const mwSequence = useAnimation();
    const mwTextSequence = useAnimation();
    const mwBetaSequence = useAnimation();

    const sequence = async () => {
        await mwSequence.start(i => ({ opacity: 1, x: 0, transition: {delay: i * .2, type: "spring", bounce: .25}}))
        await mwTextSequence.start(i => ({opacity: 1, y:0, transition: {delay: i * .12, type: "intertia", velocity: 30}}))
        await mwBetaSequence.start({opacity: 1, y: 0, transition: {type: "spring"}}).then(() => {
            setTimeout(() => sequenceExit(), 1200);
        });
    }

    const sequenceExit = async () => {
        await mwSequence.start(i => ({ opacity: 0, x: 10, transition: { type: "spring", bounce: .25}}))
        await mwTextSequence.start(i => ({opacity: 0, y:10, transition: {delay: i * .12, type: "intertia", velocity: 30}}))
        mwBetaSequence.start({opacity: 0, y: 10, transition: {type: "spring"}}).then(() => {
            setState(false);
        })
    }

    useEffect(() => {
        sequence();
    }, []);

    if(state) return <main className={"bg-slate-100 absolute inset-0 w-full h-full"}>
        <div className={"grid justify-center min-h-screen items-center"}>
          <div className={"flex items-center antialiased p-2"}>
              <svg className={"h-12"} viewBox="0 0 245 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g id={"mw"}>
                      <motion.path initial={{ opacity: 0, x: -10}} animate={mwSequence} custom={2} shapeRendering="geometricPrecision" d="M83.4788 19.2002C83.5431 19.0073 83.5108 18.7952 83.3919 18.6301C83.273 18.4651 83.082 18.3673 82.8786 18.3673H73.4361C73.1563 18.3673 72.9098 18.551 72.8298 18.8191L68.2007 34.3319L61.0955 18.8945C60.9922 18.6701 60.7678 18.5264 60.5208 18.5264H57.4498C57.2012 18.5264 56.9756 18.672 56.8732 18.8985L49.9017 34.329L45.1683 18.8154C45.0871 18.5492 44.8415 18.3673 44.5632 18.3673H35.0632C34.8593 18.3673 34.6678 18.4657 34.549 18.6315C34.4302 18.7973 34.3986 19.0102 34.4641 19.2033L44.5381 48.8852C44.6252 49.1419 44.8661 49.3145 45.1372 49.3145H52.9438C53.1981 49.3145 53.4276 49.1623 53.5266 48.928L59.0051 35.9575L64.5892 48.932C64.6891 49.1641 64.9175 49.3145 65.1703 49.3145H72.9769C73.2491 49.3145 73.4909 49.1404 73.577 48.8821L83.4788 19.2002Z" fill="#0099FF" stroke="#0099FF" strokeWidth="1.26531" strokeLinecap="round" strokeLinejoin="round"/>
                      <motion.path initial={{ opacity: 0, x: -10}} animate={mwSequence} custom={1} shapeRendering="geometricPrecision" d="M34.9825 48.7733C35.0279 49.0841 35.2945 49.3145 35.6085 49.3145H44.5632C44.7487 49.3145 44.9248 49.2331 45.0451 49.0918C45.1653 48.9505 45.2174 48.7636 45.1876 48.5804L40.3659 18.8986C40.3162 18.5923 40.0517 18.3673 39.7414 18.3673H30.9016C30.657 18.3673 30.4343 18.5084 30.3297 18.7295L23.2694 33.6554L16.2629 18.7311C16.1587 18.5091 15.9355 18.3673 15.6902 18.3673H6.85042C6.5404 18.3673 6.27604 18.592 6.22605 18.898L1.37562 48.5799C1.34569 48.763 1.39771 48.9501 1.51792 49.0916C1.63812 49.233 1.81438 49.3145 2 49.3145H10.9833C11.2978 49.3145 11.5645 49.0836 11.6095 48.7723L13.7879 33.686L21.4092 49.0165C21.5161 49.2316 21.7355 49.3675 21.9757 49.3675H24.5875C24.8276 49.3675 25.0471 49.2316 25.154 49.0165L32.7779 33.6808L34.9825 48.7733Z" fill="#111827" stroke="#111827" strokeWidth="1.26531" strokeLinecap="round" strokeLinejoin="round"/>
                  </g>
                  <g id={"text"}>
                      <motion.path initial={{ opacity: 0, y: -5}} animate={mwTextSequence} custom={1} shapeRendering="geometricPrecision"  d="M115.907 19.3991H122.078V38.3539C122.078 40.4822 121.57 42.3444 120.553 43.9406C119.546 45.5368 118.135 46.7815 116.321 47.6746C114.506 48.5582 112.392 49 109.979 49C107.556 49 105.437 48.5582 103.622 47.6746C101.808 46.7815 100.397 45.5368 99.3896 43.9406C98.3825 42.3444 97.8789 40.4822 97.8789 38.3539V19.3991H104.05V37.8266C104.05 38.9382 104.292 39.9264 104.777 40.791C105.271 41.6556 105.964 42.3349 106.858 42.829C107.751 43.323 108.791 43.5701 109.979 43.5701C111.176 43.5701 112.216 43.323 113.1 42.829C113.993 42.3349 114.682 41.6556 115.166 40.791C115.66 39.9264 115.907 38.9382 115.907 37.8266V19.3991Z" fill="black"/>
                      <motion.path initial={{opacity: 0, y: 5}} animate={mwTextSequence} custom={2} shapeRendering="geometricPrecision"  d="M133.327 19.3991V48.5867H127.156V19.3991H133.327Z" fill="black"/>
                      <motion.path initial={{ opacity: 0, y: -5}} animate={mwTextSequence} custom={3} shapeRendering="geometricPrecision"  d="M152.966 19.3991L160.02 41.5748H160.291L167.36 19.3991H174.201L164.139 48.5867H156.187L146.11 19.3991H152.966Z" fill="black"/>
                      <motion.path initial={{ opacity: 0, y: 5}} animate={mwTextSequence} custom={4} shapeRendering="geometricPrecision"  d="M188.331 48.9857C186.203 48.9857 184.308 48.62 182.645 47.8884C180.992 47.1473 179.685 46.1306 178.726 44.8385C177.776 43.5368 177.286 42.0356 177.258 40.3349H183.472C183.51 41.0475 183.742 41.6746 184.17 42.2162C184.607 42.7482 185.187 43.1615 185.909 43.4561C186.631 43.7506 187.443 43.8979 188.346 43.8979C189.286 43.8979 190.118 43.7316 190.84 43.399C191.562 43.0665 192.127 42.6057 192.536 42.0166C192.944 41.4276 193.148 40.7482 193.148 39.9786C193.148 39.1995 192.93 38.5107 192.493 37.9121C192.065 37.304 191.448 36.829 190.64 36.4869C189.842 36.1449 188.892 35.9739 187.79 35.9739H185.068V31.4418H187.79C188.721 31.4418 189.543 31.2803 190.255 30.9572C190.977 30.6342 191.538 30.1876 191.937 29.6176C192.336 29.038 192.536 28.3634 192.536 27.5938C192.536 26.8622 192.36 26.2209 192.008 25.6698C191.666 25.1093 191.182 24.6722 190.555 24.3587C189.937 24.0451 189.215 23.8884 188.388 23.8884C187.552 23.8884 186.787 24.0404 186.094 24.3444C185.4 24.639 184.844 25.0618 184.426 25.6128C184.008 26.1639 183.785 26.81 183.757 27.5511H177.842C177.871 25.8694 178.35 24.3872 179.282 23.1045C180.213 21.8219 181.467 20.8195 183.044 20.0974C184.631 19.3658 186.422 19 188.417 19C190.431 19 192.194 19.3658 193.704 20.0974C195.215 20.829 196.388 21.8171 197.225 23.0618C198.07 24.2969 198.488 25.6841 198.479 27.2233C198.488 28.8575 197.98 30.2209 196.954 31.3135C195.937 32.4062 194.612 33.0998 192.977 33.3943V33.6223C195.125 33.8979 196.759 34.6437 197.88 35.8599C199.011 37.0665 199.571 38.5772 199.562 40.3919C199.571 42.0546 199.091 43.5321 198.122 44.8242C197.163 46.1164 195.837 47.133 194.146 47.8741C192.455 48.6152 190.517 48.9857 188.331 48.9857Z" fill="black"/>
                  </g>
                  <g id={"beta"}>
                      <motion.path initial={{ opacity: 0, y: -10}} animate={mwBetaSequence} custom={1} shapeRendering="geometricPrecision"  d="M201.507 15V3.36364H206.166C207.022 3.36364 207.736 3.49053 208.308 3.74432C208.88 3.99811 209.31 4.35038 209.598 4.80114C209.885 5.24811 210.029 5.76326 210.029 6.34659C210.029 6.80114 209.938 7.20076 209.757 7.54545C209.575 7.88636 209.325 8.16667 209.007 8.38636C208.692 8.60227 208.332 8.75568 207.927 8.84659V8.96023C208.37 8.97917 208.785 9.10417 209.171 9.33523C209.562 9.56629 209.878 9.89015 210.12 10.3068C210.363 10.7197 210.484 11.2121 210.484 11.7841C210.484 12.4015 210.331 12.9527 210.024 13.4375C209.721 13.9186 209.272 14.2992 208.677 14.5795C208.082 14.8598 207.349 15 206.478 15H201.507ZM203.967 12.9886H205.973C206.658 12.9886 207.158 12.858 207.473 12.5966C207.787 12.3314 207.944 11.9792 207.944 11.5398C207.944 11.2178 207.867 10.9337 207.711 10.6875C207.556 10.4413 207.334 10.2481 207.046 10.108C206.762 9.9678 206.423 9.89773 206.029 9.89773H203.967V12.9886ZM203.967 8.23295H205.791C206.128 8.23295 206.427 8.17424 206.688 8.05682C206.954 7.93561 207.162 7.76515 207.313 7.54545C207.469 7.32576 207.546 7.0625 207.546 6.75568C207.546 6.33523 207.397 5.99621 207.098 5.73864C206.802 5.48106 206.382 5.35227 205.836 5.35227H203.967V8.23295ZM212.885 15V3.36364H220.726V5.39205H215.345V8.16477H220.322V10.1932H215.345V12.9716H220.748V15H212.885ZM223.038 5.39205V3.36364H232.595V5.39205H229.033V15H226.601V5.39205H223.038ZM235.553 15H232.917L236.934 3.36364H240.104L244.115 15H241.479L238.564 6.02273H238.473L235.553 15ZM235.388 10.4261H241.615V12.3466H235.388V10.4261Z" fill="black"/>
                  </g>
              </svg>
          </div>
        </div>
    </main>



    return  <main className={"bg-slate-100 relative w-full h-full antialiased"}>{children}</main>
}